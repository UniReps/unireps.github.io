<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Plotly Animation</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    html, body { margin: 0; padding: 0; }
    #graph { width: 100%; height: 500px; }
  </style>
</head>
<body>
  <div id="graph"></div>
  <script>
    // (Paste the same JS from A here, without DOMContentLoaded if script is at the end)
    const n = 100;
    const x = [], y = [], z = [];
    const dt = 0.005; // Reduced time step for slower, smoother animation

    for (let i = 0; i < n; i++) {
      x[i] = Math.random() * 2 - 1;
      y[i] = Math.random() * 2 - 1;
      z[i] = 30 + Math.random() * 10;
    }

    Plotly.newPlot('graph', [{
      x: x,
      y: z,
      mode: 'markers'
    }], {
      xaxis: {range: [-40, 40]},
      yaxis: {range: [0, 60]}
    }, {responsive: true});

    function compute () {
      const s = 10, b = 8/3, r = 28;
      for (let i = 0; i < n; i++) {
        let dx = s * (y[i] - x[i]);
        let dy = x[i] * (r - z[i]) - y[i];
        let dz = x[i] * y[i] - b * z[i];

        const xh = x[i] + dx * dt * 0.5;
        const yh = y[i] + dy * dt * 0.5;
        const zh = z[i] + dz * dt * 0.5;

        dx = s * (yh - xh);
        dy = xh * (r - zh) - yh;
        dz = xh * yh - b * zh;

        x[i] += dx * dt;
        y[i] += dy * dt;
        z[i] += dz * dt;
      }
    }

    function update () {
      compute();
      Plotly.animate('graph', { data: [{x, y: z}] }, {
        transition: { duration: 0 },
        frame: { duration: 0, redraw: false }
      });
      requestAnimationFrame(update);
    }

    requestAnimationFrame(update);
  </script>
</body>
</html>
